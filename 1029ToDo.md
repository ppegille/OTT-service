# OTT 스트리밍 서버 프로젝트 - 진행 상황 (2025-10-29)

## 📌 현재 상태 요약

**프로젝트**: OTT 비디오 스트리밍 서버 (C언어, 네트워크프로그래밍 기말 프로젝트)
**마감일**: 2025년 12월 10일 (금요일)
**현재 단계**: MVP Phase 2 구현 완료, 테스트 대기 중

---

## ✅ 완료된 작업

### PREPARATION PHASE (완료)
- [x] 프로젝트 요구사항 분석 (CLAUDE.md)
- [x] 시스템 아키텍처 설계 (README_ARCHITECTURE.md)
- [x] HTTP Range Request 학습 자료 작성 (PREPARATION_GUIDE.md)
- [x] WSL2 환경 설정 가이드 작성 (WSL_설치가이드.md)
- [x] Practice 예제 4개 완성 및 테스트 완료
  - exercise1: Basic HTTP server
  - exercise2: File server
  - exercise3: Range requests with text
  - exercise4: Video streaming

### MVP PHASE 1 (완료)
- [x] 프로젝트 디렉토리 구조 생성
- [x] server/include/server.h - 헤더 파일 구현
- [x] server/src/main.c - 메인 HTTP 서버 구현
- [x] server/src/http.c - HTTP 요청/응답 처리
- [x] server/src/streaming.c - Range Request 비디오 스트리밍
- [x] server/Makefile - 빌드 설정
- [x] client/player.html - 비디오 플레이어 UI
- [x] MVP_PHASE1_실행가이드.md 작성
- [x] 단일 사용자 비디오 스트리밍 테스트 성공 ("잘 작동합니다")

### MVP PHASE 2 (구현 완료, 테스트 대기)
- [x] Fork-based 동시 접속 처리 구현
  - main.c에 fork() 로직 추가
  - SIGCHLD 시그널 핸들러 추가 (좀비 프로세스 방지)
  - Parent/Child 프로세스 분리
- [x] MVP_PHASE2_실행가이드.md 작성
- [x] tests/concurrent_test.sh 자동 테스트 스크립트 작성
- [ ] **다음 작업**: 서버 재컴파일 및 동시 접속 테스트

---

## 🔄 현재 진행 중 (다음에 할 작업)

### 1. MVP Phase 2 테스트 (최우선)

#### Step 1: 서버 재컴파일
```bash
cd "/mnt/c/Users/dclab/Desktop/2025_2학기/네트워크프로그래밍/기말프로젝트/server"
make clean
make
```

**확인 사항**:
- 컴파일 에러 없이 완료되어야 함
- `ott_server` 실행 파일 생성 확인

#### Step 2: Phase 2 서버 실행
```bash
./ott_server
```

**확인 사항**:
- 출력에 "MVP Phase 2" 표시
- "Fork-based Concurrent Connection Support" 메시지 표시
- 포트 8080에서 listening 시작

#### Step 3: 브라우저 동시 접속 테스트
1. Chrome 브라우저에서 3개 탭 열기
2. 각 탭에서 `http://localhost:8080/` 접속
3. 모든 탭에서 비디오 재생 버튼 클릭
4. 서버 터미널에서 각기 다른 Child PID 표시 확인

**성공 기준**:
- ✅ 3개 탭 모두 비디오 재생됨
- ✅ 서버 로그에 다른 Child PID 표시
- ✅ 각 탭이 독립적으로 Seek 작동

#### Step 4: 자동 테스트 스크립트 실행 (선택)
```bash
# 새 터미널 창에서 (서버는 계속 실행)
cd "/mnt/c/Users/dclab/Desktop/2025_2학기/네트워크프로그래밍/기말프로젝트/tests"
bash concurrent_test.sh
```

**성공 기준**: "✅ 모든 테스트 통과!" 메시지 표시

---

## 📋 다음 단계 로드맵

### MVP PHASE 2 완료 후 (다음 세션)

#### 1. 세션 관리 구현
- [ ] 쿠키 기반 UUID 세션 생성
- [ ] 인메모리 세션 저장소 (해시맵 또는 배열)
- [ ] 세션 타임아웃 메커니즘

#### 2. 간단한 로그인 페이지
- [ ] login.html 작성 (ID만 입력, 비밀번호 없음)
- [ ] 로그인 폼 제출 처리
- [ ] 세션 쿠키 발급
- [ ] 로그인 성공 시 player.html로 리다이렉트

#### 3. 세션 검증
- [ ] 모든 비디오 요청에서 세션 쿠키 확인
- [ ] 유효하지 않은 세션은 login.html로 리다이렉트
- [ ] 세션 만료 처리

---

## 🎯 최종 목표 (프로젝트 완료까지)

### ENHANCEMENT PHASE 1: Database & Authentication
- [ ] SQLite 데이터베이스 연동
- [ ] users, sessions, videos, watch_history 테이블 생성
- [ ] SHA-256 비밀번호 해싱
- [ ] 데이터베이스 기반 인증

### ENHANCEMENT PHASE 2: Advanced Features
- [ ] 비디오 목록 페이지 구현
- [ ] FFmpeg 썸네일 자동 생성
- [ ] 시청 기록 저장 및 이어보기 기능
- [ ] 사용자 지정 재생 시작 위치

### POLISH PHASE: Testing & Delivery
- [ ] 보안 테스트 (SQL injection, XSS 등)
- [ ] 성능 벤치마크 (5명 이상 동시 접속)
- [ ] valgrind 메모리 누수 검사
- [ ] 프로젝트 보고서 작성
- [ ] 최종 코드 패키지 준비

---

## 📂 프로젝트 파일 구조

```
기말프로젝트/
├── server/
│   ├── include/
│   │   └── server.h               ✅ 완료
│   ├── src/
│   │   ├── main.c                 ✅ Phase 2 완료 (테스트 필요)
│   │   ├── http.c                 ✅ 완료
│   │   └── streaming.c            ✅ 완료
│   ├── Makefile                   ✅ 완료
│   └── ott_server                 (컴파일 후 생성)
├── client/
│   └── player.html                ✅ 완료
├── videos/
│   └── test_video.mp4             ✅ 준비됨
├── tests/
│   └── concurrent_test.sh         ✅ 완료 (테스트 필요)
├── practice/                      ✅ 완료
├── CLAUDE.md                      ✅ 프로젝트 요구사항
├── README_ARCHITECTURE.md         ✅ 시스템 설계
├── PREPARATION_GUIDE.md           ✅ 학습 자료
├── WSL_설치가이드.md              ✅ 환경 설정
├── MVP_PHASE1_실행가이드.md       ✅ Phase 1 가이드
├── MVP_PHASE2_실행가이드.md       ✅ Phase 2 가이드
└── 1029ToDo.md                    ✅ 이 파일
```

---

## 💡 중요 참고 사항

### 주요 구현 내용

**HTTP Range Request 처리** (server/src/streaming.c):
- RFC 7233 표준 준수
- 206 Partial Content 응답
- Content-Range 헤더 생성
- Seeking 지원

**Fork-based 동시 접속** (server/src/main.c):
- Parent 프로세스: 연결 대기 (무한 루프)
- Child 프로세스: 각 클라이언트 요청 처리
- SIGCHLD 핸들러: 좀비 프로세스 자동 회수
- 프로세스 격리: 각 사용자 독립적

### 테스트 확인 사항
1. **단일 사용자**: Phase 1에서 이미 확인 완료 ✅
2. **다중 사용자**: Phase 2에서 확인 필요 ⏳
3. **프로세스 격리**: Child PID가 각각 다른지 확인
4. **리소스 관리**: 좀비 프로세스 없는지 확인 (`ps aux | grep defunct`)

### 자주 사용하는 명령어
```bash
# 서버 빌드
cd server && make clean && make

# 서버 실행
./ott_server

# 서버 중지
Ctrl + C
# 또는
pkill ott_server

# 프로세스 확인
ps aux | grep ott_server

# 포트 사용 확인
netstat -antp | grep 8080

# 테스트 실행
cd tests && bash concurrent_test.sh
```

---

## 🐛 알려진 이슈 및 해결 방법

### 이슈 1: "Address already in use"
**원인**: 이전 서버 프로세스가 종료되지 않음
**해결**: `pkill ott_server` 또는 `lsof -ti:8080 | xargs kill -9`

### 이슈 2: "Permission denied"
**원인**: 실행 권한 없음
**해결**: `chmod +x ott_server`

### 이슈 3: WSL 경로 접근 오류
**원인**: Windows 경로 형식 문제
**해결**: `/mnt/c/Users/...` 형식 사용

---

## 📞 다음 세션 시작 시

1. **이 파일(1029ToDo.md) 먼저 읽기**
2. **"현재 진행 중" 섹션부터 작업 시작**
3. 테스트가 성공하면 "세션 관리 추가해주세요" 요청
4. 문제 발생 시 MVP_PHASE2_실행가이드.md의 "문제 해결" 섹션 참고

---

## ✨ 프로젝트 진행률

**전체 진행률**: 약 40% 완료

- ✅ Preparation Phase: 100%
- ✅ MVP Phase 1: 100%
- 🔄 MVP Phase 2: 95% (테스트만 남음)
- ⏳ Enhancement Phase 1: 0%
- ⏳ Enhancement Phase 2: 0%
- ⏳ Polish Phase: 0%

**예상 소요 시간**:
- MVP Phase 2 완료: 1시간
- Enhancement Phase 1: 2-3일
- Enhancement Phase 2: 3-4일
- Polish Phase: 2-3일

**마감까지 남은 시간**: 약 6주

---

**작성 시간**: 2025-10-29
**다음 작업**: MVP Phase 2 동시 접속 테스트
**상태**: 코드 구현 완료, 컴파일 및 테스트 대기 중

**잘 작동하길 바랍니다! 다음에 뵙겠습니다! 🚀**
